---
title: npm è„šæœ¬å‘½ä»¤ä½¿ç”¨è§£æ
tags: npm
categories: NPM
description: npmè„šæœ¬å‘½ä»¤æ˜¯æ¯ä¸ªå‰ç«¯ç¨‹åºå‘˜éƒ½ä¼šé«˜é¢‘ä½¿ç”¨çš„å‘½ä»¤ï¼Œé‚£ä¹ˆä½ å¯¹å®ƒäº†è§£å¤šå°‘å‘¢ï¼Œæœ¬ç¯‡æ˜¯åˆè¯†npmè„šæœ¬å‘½ä»¤ï¼Œåé¢é™†ç»­ä»‹ç»å…¶å®ƒå‘½ä»¤ã€‚
abbrlink: 2334529800
date: 2022-09-29 18:28:22
---

> æœ¬ç¯‡æ˜¯åˆè¯†npmè„šæœ¬å‘½ä»¤ï¼Œæ¥ä¸ªå¼•å­ï¼Œçœ‹çœ‹é£å‘ï¼Œå¯ä»¥çš„è¯åé¢é™†ç»­ä»‹ç»å…¶å®ƒå®ç”¨å‘½ä»¤ğŸ˜‰ã€‚

## 1ã€æ‰§è¡ŒåŸç†

ä½¿ç”¨npm run scriptæ‰§è¡Œè„šæœ¬çš„æ—¶å€™éƒ½ä¼šåˆ›å»ºä¸€ä¸ªshellï¼Œç„¶ååœ¨shellä¸­æ‰§è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

è¿™ä¸ªshellä¼šå°†å½“å‰é¡¹ç›®çš„å¯æ‰§è¡Œä¾èµ–ç›®å½•ï¼ˆå³`node_modules/.bin`ï¼‰æ·»åŠ åˆ°ç¯å¢ƒå˜é‡pathä¸­ï¼Œå½“æ‰§è¡Œä¹‹åä¹‹åå†æ¢å¤åŸæ ·ã€‚å°±æ˜¯è¯´è„šæœ¬å‘½ä»¤ä¸­çš„ä¾èµ–åä¼šç›´æ¥æ‰¾åˆ°node_modules/.binä¸‹é¢çš„å¯¹åº”è„šæœ¬ï¼Œè€Œä¸éœ€è¦åŠ ä¸Šè·¯å¾„ã€‚

## 2ã€æ‰§è¡Œé¡ºåº

ä¸€ä¸ªnpmè„šæœ¬å¯ä»¥æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡ä¹‹é—´å¯ä»¥æŒ‡å®šä¸åŒçš„æ‰§è¡Œé¡ºåºã€‚

1. '&' å¹¶è¡Œæ‰§è¡Œé¡ºåºï¼ŒåŒæ—¶æ‰§è¡Œ
```
"dev":"node test.js & webpack"
```
2. '&&'ç»§å‘é¡ºåºï¼Œæ‰§è¡Œå‰é¢ä¹‹åæ‰å¯ä»¥æ‰§è¡Œåé¢

```
"dev":"node test.js && webpack"
```

## 3ã€é¡ºåºé’©å­

npmè„šæœ¬è‡ªå¸¦ä¸¤ä¸ªé¡ºåºé’©å­ï¼Œ'pre' å’Œ 'post'

```
"predev":"node test_one.js",
"dev":"node test_two.js",
"postdev":"node test_three.js"
```

å½“æ‰§è¡Œ npm run dev çš„æ—¶å€™é»˜è®¤å°±ä¼šæ‰§è¡Œ

```
npm run predev && npm run dev && npm run postdev
```

## 4ã€ç”Ÿå‘½å‘¨æœŸè„šæœ¬

1.  `prepare`: (@4.0.0) åœ¨æ‰“åŒ…ä¹‹å‰è¿è¡Œï¼Œæ–°ç‰ˆçš„**husky**å°±æ˜¯å†™å…¥çš„prepareè„šæœ¬ï¼Œè¿›è¡Œå®‰è£…çš„ï¼š`"prepare": "husky install",`ã€‚

    ğŸ‘‰ è‹¥æƒ³äº†è§£ä»£ç è§„èŒƒä»¥åŠgitæäº¤ä¿¡æ¯è§„èŒƒï¼Œè¯·æ¥[è¿™é‡Œ](https://juejin.cn/post/7110083169067466766)

2.  `prepublish`: åœ¨åŒ…å‘å¸ƒä¹‹å‰è¿è¡Œ

3.  `prepublishOnly`: åœ¨æœ¬åœ°è¿è¡Œï¼Œnpm installæ²¡æœ‰ä»»ä½•å‚æ•°

4.  `prepack`: è¿è¡Œä¹‹åprepublishï¼Œä½†ä¹‹å‰prepublishOnly

5.  `postpack`: æ³¨æ„ï¼šå¦‚æœé€šè¿‡ git å®‰è£…çš„åŒ…åŒ…å«prepareè„šæœ¬ï¼Œåˆ™åœ¨æ‰“åŒ…å’Œå®‰è£…åŒ…ä¹‹å‰dependenciesï¼ŒdevDependencieså°†å®‰è£…è¯¥è„šæœ¬ï¼Œå¹¶è¿è¡Œå‡†å¤‡è„šæœ¬ã€‚

æœ‰ä¸€äº›ç‰¹æ®Šçš„ç”Ÿå‘½å‘¨æœŸè„šæœ¬åªåœ¨æŸäº›æƒ…å†µä¸‹å‘ç”Ÿã€‚ä¸Šé¢è¿™äº›è„šæœ¬å‘ç”Ÿåœ¨â€œpreâ€å’Œâ€œpostâ€è„šæœ¬ä¹‹å¤–ã€‚

## 5ã€è·å–å½“å‰æ­£åœ¨è¿è¡Œçš„è„šæœ¬åç§°

npm æä¾›ä¸€ä¸ª `npm_lifecycle_event` å˜é‡ï¼Œè¿”å›å½“å‰æ­£åœ¨è¿è¡Œçš„è„šæœ¬åç§°ï¼Œå¯ä»¥é…åˆé¡ºåºé’©å­ä½¿ç”¨

```
npm run dev


const target = process.env.npm_lifecycle_event;

if(target === 'predev'){
  console.log('the process is predev')
}
if(target === 'dev'){
  console.log('the process is dev')
}
if(target === 'postdev'){
  console.log('this process is postdev')
}
```

## 6ã€å››ä¸ªå¯ä»¥ç®€å†™çš„è„šæœ¬æ‰§è¡Œå‘½ä»¤

```
npm start === npm run start
npm stop === npm run stop
npm test === npm run test
npm restart === npm run stop && npm run restart && npm run start
```

## 7ã€ä½¿ç”¨package.jsonå†…éƒ¨å˜é‡

é€šè¿‡npm_package_å‰ç¼€ï¼Œnpmè„šæœ¬å¯ä»¥æ‹¿åˆ°npmçš„å†…éƒ¨å˜é‡

`package.json:`
```json
{
  "name" : "foo",
  "config" : {
    "port" : "8080"
  },
  "scripts" : {
    "start" : "node server.js"
  }
}
```

`test.js`
```js
console.log(process.env.npm_package_config_port) // 8080
```

ğŸ‘‰ æ›´å¤šè¯·çœ‹ï¼š[å®˜æ–¹æ–‡æ¡£](https://docs.npmjs.com/cli/v6/using-npm/scripts)

---

![](https://cdn.jsdelivr.net/gh/all-smile/nav@1.0.7/static/images/wind_girl.webp)


æˆ‘æ˜¯ [**ç”œç‚¹cc**](https://blog.i-xiao.space/)

çƒ­çˆ±å‰ç«¯ï¼Œä¹Ÿå–œæ¬¢ä¸“ç ”å„ç§è·Ÿæœ¬èŒå·¥ä½œå…³ç³»ä¸å¤§çš„æŠ€æœ¯ï¼ŒæŠ€æœ¯ã€äº§å“å…´è¶£å¹¿æ³›ä¸”æµ“åšï¼Œç­‰å¾…ç€ä¸€ä¸ªåˆ›ä¸šæœºä¼šã€‚ä¸»è¦è‡´åŠ›äºåˆ†äº«å®ç”¨æŠ€æœ¯å¹²è´§ï¼Œå¸Œæœ›å¯ä»¥ç»™ä¸€å°éƒ¨åˆ†äººä¸€äº›å¾®å°å¸®åŠ©ã€‚

æˆ‘æ’æ–¥â€œæ–°äººè¿·èŒ«ï¼Œè€äººçœ‹æˆâ€çš„ç°è±¡ï¼Œå¸Œæœ›èƒ½å’Œå¤§å®¶ä¸€èµ·åŠªåŠ›ç ´å±€ã€‚è¥é€ ä¸€ä¸ªè‰¯å¥½çš„æŠ€æœ¯æ°›å›´ï¼Œä¸ºäº†ä¸ªäººã€ä¸ºäº†æˆ‘å›½çš„æ•°å­—åŒ–è½¬å‹ã€äº’è”ç½‘ç‰©è”ç½‘æŠ€æœ¯ã€æ•°å­—ç»æµå‘å±•åšä¸€ç‚¹ç‚¹è´¡çŒ®ã€‚**æ•°é£æµäººç‰©è¿˜çœ‹ä¸­å›½ã€çœ‹ä»Šæœã€çœ‹ä½ æˆ‘ã€‚**